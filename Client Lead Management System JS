let leads = JSON.parse(localStorage.getItem("leads")) || [];

const leadForm = document.getElementById("leadForm");
const leadTable = document.getElementById("leadTable");

leadForm.addEventListener("submit", function (e) {
    e.preventDefault();

    const lead = {
        name: document.getElementById("name").value,
        email: document.getElementById("email").value,
        phone: document.getElementById("phone").value,
        status: document.getElementById("status").value
    };

    const index = document.getElementById("leadIndex").value;

    if (index === "") {
        leads.push(lead);
    } else {
        leads[index] = lead;
        document.getElementById("leadIndex").value = "";
    }

    localStorage.setItem("leads", JSON.stringify(leads));
    leadForm.reset();
    renderLeads();
});

function renderLeads() {
    leadTable.innerHTML = "";

    leads.forEach((lead, index) => {
        leadTable.innerHTML += `
            <tr>
                <td>${lead.name}</td>
                <td>${lead.email}</td>
                <td>${lead.phone}</td>
                <td>${lead.status}</td>
                <td>
                    <button class="edit" onclick="editLead(${index})">Edit</button>
                    <button class="delete" onclick="deleteLead(${index})">Delete</button>
                </td>
            </tr>
        `;
    });
}

function editLead(index) {
    const lead = leads[index];
    document.getElementById("name").value = lead.name;
    document.getElementById("email").value = lead.email;
    document.getElementById("phone").value = lead.phone;
    document.getElementById("status").value = lead.status;
    document.getElementById("leadIndex").value = index;
}

function deleteLead(index) {
    if (confirm("Are you sure you want to delete this lead?")) {
        leads.splice(index, 1);
        localStorage.setItem("leads", JSON.stringify(leads));
        renderLeads();
    }
}

renderLeads();
